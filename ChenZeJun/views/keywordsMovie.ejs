<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Document</title>
        <link rel="stylesheet" href="/css/Details.css">
        <link rel="stylesheet" href="/css/reset.css">
        <!-- 合并底部css -->
        <link rel="stylesheet" href="/css/bottom.css">
        <!-- 合并头部css -->
        <link rel="stylesheet" href="/css/hand.css">
        <!-- 引入bootstarp -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body>

        <!-- 头部开始 -->
        <%- include('./layouts/hand.ejs') %>
        <!-- 头部结束 -->

        <!-- 导航部分开始 -->
        <div class="nav">
                <div class="common">
                        <div class="nav_top">
                                <span>当前位置: </span>
                                <a href="/">首页</a>
                                <span>>最新电影</span>
                        </div>
                        <div class="nav_bottom clearfix">
                                <div class="nav_bottom_left">
                                        <p>最新电影</p>
                                </div>
                                <div class="nav_bottom_right clearfix">
                                        <span class="filter">筛选</span>
                                        <i class="filter_icon"></i>
                                        <div class="nav_list">
                                                <dl class="clearfix">
                                                        <dt><span>按分类</span></dt>

                                                        <dd><a href="/vod-type-id-5-pg-1.html">动作片</a></dd>

                                                        <dd><a href="/vod-type-id-6-pg-1.html">喜剧片</a></dd>

                                                        <dd><a href="/vod-type-id-7-pg-1.html">爱情片</a></dd>

                                                        <dd><a href="/vod-type-id-8-pg-1.html">科幻片</a></dd>

                                                        <dd><a href="/vod-type-id-9-pg-1.html">恐怖片</a></dd>

                                                        <dd><a href="/vod-type-id-10-pg-1.html">剧情片</a></dd>

                                                        <dd><a href="/vod-type-id-11-pg-1.html">战争片</a></dd>

                                                        <dd><a href="/vod-type-id-17-pg-1.html">纪录片</a></dd>

                                                        <dd><a href="/vod-type-id-18-pg-1.html">冒险片</a></dd>

                                                        <dd><a href="/vod-type-id-19-pg-1.html">悬疑片</a></dd>

                                                        <dd><a href="/vod-type-id-20-pg-1.html">犯罪片</a></dd>

                                                        <dd><a href="/vod-type-id-26-pg-1.html">惊悚片</a></dd>

                                                        <dd><a href="/vod-type-id-27-pg-1.html">动画片</a></dd>

                                                        <dd><a href="/vod-type-id-16-pg-1.html">微电影</a></dd>

                                                        <dd><a href="/vod-type-id-25-pg-1.html">其他片</a></dd>

                                                </dl>
                                                <dl class="clearfix">
                                                        <dt><span>按年代</span></dt>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2019-letter--area--lang-.html">2019</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2018-letter--area--lang-.html">2018</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2017-letter--area--lang-.html">2017</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2016-letter--area--lang-.html">2016</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2015-letter--area--lang-.html">2015</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2014-letter--area--lang-.html">2014</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2013-letter--area--lang-.html">2013</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2012-letter--area--lang-.html">2012</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2011-letter--area--lang-.html">2011</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2010-letter--area--lang-.html">2010</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2009-letter--area--lang-.html">2009</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2008-letter--area--lang-.html">2008</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2007-letter--area--lang-.html">2007</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2006-letter--area--lang-.html">2006</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2005-letter--area--lang-.html">2005</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2004-letter--area--lang-.html">2004</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2003-letter--area--lang-.html">2003</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2002-letter--area--lang-.html">2002</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2001-letter--area--lang-.html">2001</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-2000-letter--area--lang-.html">2000</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-1999-letter--area--lang-.html">1999</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-1998-letter--area--lang-.html">1998</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-1997-letter--area--lang-.html">1997</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-1996-letter--area--lang-.html">1996</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year-1995-letter--area--lang-.html">1995</a>
                                                        </dd>

                                                </dl>
                                                <d class="clearfix">
                                                        <dt><span>按地区</span></dt>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%A4%A7%E9%99%86-lang-.html">大陆</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E9%A6%99%E6%B8%AF-lang-.html">香港</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%8F%B0%E6%B9%BE-lang-.html">台湾</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E7%BE%8E%E5%9B%BD-lang-.html">美国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E9%9F%A9%E5%9B%BD-lang-.html">韩国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E6%97%A5%E6%9C%AC-lang-.html">日本</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E6%B3%B0%E5%9B%BD-lang-.html">泰国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E6%96%B0%E5%8A%A0%E5%9D%A1-lang-.html">新加坡</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E9%A9%AC%E6%9D%A5%E8%A5%BF%E4%BA%9A-lang-.html">马来西亚</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%8D%B0%E5%BA%A6-lang-.html">印度</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E8%8B%B1%E5%9B%BD-lang-.html">英国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E6%B3%95%E5%9B%BD-lang-.html">法国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%8A%A0%E6%8B%BF%E5%A4%A7-lang-.html">加拿大</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E8%A5%BF%E7%8F%AD%E7%89%99-lang-.html">西班牙</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E4%BF%84%E7%BD%97%E6%96%AF-lang-.html">俄罗斯</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%BE%B7%E5%9B%BD-lang-.html">德国</a>
                                                        </dd>

                                                        <dd><a rel="nofollow"
                                                                        href="/vod-list-id-1-pg-1-order--by--class--year--letter--area-%E5%85%B6%E5%AE%83-lang-.html">其它</a>
                                                        </dd>


                                                </d>
                                        </div>
                                </div>
                        </div>
                        <div class="filter_results clearfix">
                                <p class="results">
                                        <script type="text/template" id="page_template">
                                                {{each}}
                                                共<span>{{list}}</span> 个筛选结果
                                        {{/each}}
                                        </script>
                                </p>
                                <p class="px">

                                        <a href="">
                                                最新
                                                <i></i>
                                        </a>
                                        <a href=""><i></i>热门</a>
                                        <a href=""><i></i>推荐</a>
                                </p>
                        </div>

                </div>
        </div>
        <!-- 导航部分结束 -->

        <!--   最新电影 -->
        <div class="news_movie">
                <div class="common">
                        <div class="news_movie_center">
                                <ul class="news_movie_temp clearfix">
                                        <script type="text/template" id="movie_template">
                                                {{each list}}
                                <li>
                                        <a href=""><img src="{{$value.image_url}}" alt=""><i>HD</i></a>
                                        <div class="hot_movie">
                                            <p class="name">{{$value.film_name}}</p>
                                            <p class="actor">{{$value.star}}</p>
                                            <p class="type">{{$value.type_name}}</p>
                                            <p class="time">{{$value.adress}}</p>
                                            <a href="/intro/{{$value.id}}">      
                                            </a>
                                        </div>
                                </li>
                             {{/each}}
                        </script>
                                </ul>
                        </div>

                </div>
        </div>


        <!-- 分页 -->
        <div class="common">
                <ul class="pagination pagination-lg">
                        <li><a href=" #">上一页</a></li>
                        <li><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <!-- <li><a href="#">下一页</a></li> -->
                </ul>
        </div>

        <!-- 底部 -->
        <%- include('./layouts/footer.ejs') %>


        <!-- js部分 -->

        <!-- 头部 -->
        <script src="/js/hand.js"></script>

        <!-- 分页 -->
        <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
        <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
        <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
        <script src="/js/jquery-3.3.1.js"></script>
        <script src="/js/template/template-web.js"></script>
        <script src="/js/twbs-pagination/jquery.twbsPagination.min.js"></script>
        <!-- ajax请求 -->
        <script>
                // 首页渲染
                let show = function (pagenum, pagesize) {
                        $("a").css("text-decoration", "none"); //去掉下划线
                        // 获取地址栏参数
                        var name, value;
                        var str = location.href; //取得整个地址栏
                        // console.log(str)
                        var num = str.indexOf("?")
                        str = str.substr(num + 1); //取得所有参数   stringvar.substr(start [, length ]
                        var arr = str.split("/"); //各个参数放到数组里
                        var keywords = arr.length - 1;
                        let arr2 = decodeURIComponent(arr[keywords])
                        console.log(arr2)
                        // 分页
                        $.ajax({
                                url: "http://127.0.0.1/api/v1/films",
                                type: "get",
                                data: {
                                        page: pagenum || 1,
                                        per_page: pagesize || 3,
                                        type_name: "电影",
                                        keywords: arr2
                                },
                                success: function (data) {
                                        console.log(data)
                                        let MovieHtml = template('movie_template', {
                                                list: data.data,
                                        })
                                        // console.log(MovieHtml)
                                        $('.news_movie_temp').html(MovieHtml)


                                        // 分页
                                        $('.pagination').twbsPagination({
                                                // 总页数
                                                totalPages: Math.ceil(
                                                        data
                                                        .total /
                                                        data
                                                        .per_page
                                                ),
                                                visiblePages: 3,
                                                // 当你点击的时候 获取页码
                                                onPageClick: function (
                                                        evt,
                                                        page) {
                                                        show(
                                                                page
                                                        );
                                                }
                                        });
                                }
                        })
                        // 总条数
                        $.ajax({
                                url: "http://127.0.0.1/api/v1/films",
                                type: "get",
                                data: {
                                        keywords: arr2
                                },
                                success: function (data) {
                                        console.log(data)
                                        let pageHtml = template('page_template', {
                                                list: data.total
                                        })
                                        $('.results').html(pageHtml)
                                }
                        })
                }
                show();
        </script>
</body>

</html>